Teams PowerShell module
To use Windows PowerShell to run Teams-related commands, you must first install the Teams PowerShell module by running the following command in an elevated PowerShell session:

PowerShell
Install-Module -Name MicrosoftTeams
After installing the module, it is loaded into all new PowerShell sessions and the cmdlets are available for configuring policies and settings, such as creating and managing teams.

Before you can work with the Teams PowerShell module, you must establish a connection to a tenant by running the following cmdlet:

PowerShell
Connect-MicrosoftTeams
If you want to see a list of all the cmdlets that are included in the Microsoft Teams PowerShell module, you should run the following command:

PowerShell
Get-Command -Module MicrosoftTeams



Assign admin roles with PowerShell
Assigning admin roles with PowerShell is used when you want to automate the process of assignment or you need to perform bulk assignments in Microsoft Entra ID. To assign an admin role, you need to run New-MgDirectoryRoleMemberByRef cmdlet in Microsoft Graph PowerShell module. For example, if you want to assign LynneR@contoso.com the admin role Teams Administrator, run the following cmdlets:

PowerShell
$userName="LynneR@contoso.com"
$roleName="Teams Administrator"
$role = Get-MgDirectoryRole | Where-Object {$_.displayName -eq $roleName}
$userId = (Get-MgUser | Where-Object {$_.UserPrincipalName -eq $userName}).Id
Run the snippet below to perform the assignment based on the variables above.

PowerShell
Import-Module Microsoft.Graph.Identity.DirectoryManagement

$params = @{
	"@odata.id" = "https://graph.microsoft.com/v1.0/directoryObjects/$userId"
}
New-MgDirectoryRoleMemberByRef -DirectoryRoleId $role.Id -BodyParameter $params

For More https://learn.microsoft.com/en-us/microsoft-365/enterprise/assign-roles-to-user-accounts-with-microsoft-365-powershell

#Manage feedback policies
By default, all users in your organization are automatically assigned the global (Org-wide default) policy, and the feedback feature and survey are enabled in the policy. You can edit the global policy or create and assign a custom policy. After you edit the global policy or assign a custom policy, it can take a few hours for changes to take effect.

You manage feedback policies by using PowerShell:

Use the New-CsTeamsFeedbackPolicy PowerShell cmdlet to create a custom policy.

Use the Grant-CsTeamsFeedbackPolicy PowerShell cmdlet to assign it to one or more users or groups of users, such as a security group or distribution group.

Use the Set-CsTeamsFeedbackPolicy PowerShell cmdlet to set specific flags.

To turn off and turn on the features, set the following parameters:

Give feedback: Set the userInitiatedMode parameter to enabled to allow users who are assigned the policy to give feedback. Setting the parameter to disabled turns off the feature and users who are assigned the policy don't have the option to give feedback.

Surveys: Set the receiveSurveysMode parameter to enabled to allow users who are assigned the policy to receive the survey. To have users receive the survey and allow them to opt out, set the parameter to enabledUserOverride. In Teams, users can then go to Settings > Privacy and choose whether they want to participate in surveys. Setting the parameter to disabled turns off the feature and users who are assigned the policy won't receive the survey.

Email: Use the AllowEmailCollection flag to add an email field.

Log collection: Use the AllowLogCollection flag to add log collection opt-in for users. Log collection is currently enabled only on mobile.

The following example creates a feedback policy called New Hire Feedback Policy and we turn off the ability to give feedback through Give feedback and the survey.

PowerShell
New-CsTeamsFeedbackPolicy -identity "New Hire Feedback Policy" -userInitiatedMode disabled -receiveSurveysMode disabled
Then, assign a custom policy named New Hire Feedback Policy to a user named user1.

PowerShell
Grant-CsTeamsFeedbackPolicy -Identity user1@contoso.com -PolicyName "New Hire Feedback Policy"


Use PowerShell
Admins can also turn on Safe Attachments by connecting to Exchange Online PowerShell (Connect-ExchangeOnline) and using the following command:

Powershell
Set-AtpPolicyForO365 -EnableATPForSPOTeamsODB $true
By default, people can download a blocked file. Global admins or SharePoint admins can prevent people from downloading malicious files by connecting to SharePoint Online PowerShell (Connect-SPOService) and running the following command:

Powershell
Set-SPOTenant -DisallowInfectedFileDownload $true
